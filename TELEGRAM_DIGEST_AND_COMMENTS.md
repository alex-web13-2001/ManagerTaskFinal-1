# Telegram Bot: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–≤–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Telegram-–±–æ—Ç T24:

1. **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –∑–∞–¥–∞—á** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º Telegram –≤ 09:00 –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
2. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö** - –ø–æ–∑–≤–æ–ª—è—é—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä—è–º–æ –∏–∑ Telegram

---

## 1. –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –∑–∞–¥–∞—á

### –û–ø–∏—Å–∞–Ω–∏–µ

–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ **09:00 –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ (06:00 UTC)** –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º Telegram-–∞–∫–∫–∞—É–Ω—Ç–æ–º –ø–æ–ª—É—á–∞—é—Ç —Å–≤–æ–¥–∫—É –ø–æ —Å–≤–æ–∏–º –∑–∞–¥–∞—á–∞–º.

### –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –¥–∞–π–¥–∂–µ—Å—Ç

–î–∞–π–¥–∂–µ—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–¥–∞—á:

1. **–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏** - –∑–∞–¥–∞—á–∏ —Å –¥–µ–¥–ª–∞–π–Ω–æ–º –¥–æ –Ω–∞—á–∞–ª–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è
2. **–ó–∞–¥–∞—á–∏ —Å –¥–µ–¥–ª–∞–π–Ω–æ–º –≤ –±–ª–∏–∂–∞–π—à–∏–µ 3 –¥–Ω—è** - –∑–∞–¥–∞—á–∏ —Å –¥–µ–¥–ª–∞–π–Ω–æ–º –æ—Ç —Å–µ–≥–æ–¥–Ω—è –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è —á–µ—Ä–µ–∑ 3 –¥–Ω—è

### –£—Å–ª–æ–≤–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏

- –î–∞–π–¥–∂–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏** —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –µ—Å—Ç—å –∑–∞–¥–∞—á–∏
- –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏:
  - –ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`assigneeId`)
  - –ù–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ (`status != 'done'`)
  - –° —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –¥–µ–¥–ª–∞–π–Ω–æ–º (`dueDate != null`)

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

```
üóì –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –∑–∞–¥–∞—á–∞–º

–ü—Ä–∏–≤–µ—Ç, {–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è}!

üìå –ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –Ω–∞ –≤–∞—Å –∑–∞–¥–∞—á–∏:

‚è∞ –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ:
1) [üî¥ –í—ã—Å–æ–∫–∏–π] –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (–¥–µ–¥–ª–∞–π–Ω: 15.11)
   üìÅ –ü—Ä–æ–µ–∫—Ç: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
   üîó –û—Ç–∫—Ä—ã—Ç—å: http://example.com/tasks/task-id
...

üìÜ –î–µ–¥–ª–∞–π–Ω –≤ –±–ª–∏–∂–∞–π—à–∏–µ 3 –¥–Ω—è:
1) [üü° –°—Ä–µ–¥–Ω–∏–π] –î—Ä—É–≥–∞—è –∑–∞–¥–∞—á–∞ (–¥–µ–¥–ª–∞–π–Ω: —Å–µ–≥–æ–¥–Ω—è)
   üîó –û—Ç–∫—Ä—ã—Ç—å: http://example.com/tasks/task-id
...

–í—Å–µ–≥–æ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö: X
–ó–∞–¥–∞—á —Å –¥–µ–¥–ª–∞–π–Ω–æ–º –≤ –±–ª–∏–∂–∞–π—à–∏–µ 3 –¥–Ω—è: Y

üîó –û—Ç–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á: http://example.com/tasks?filter=my
```

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `node-cron` —Å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º `0 6 * * *`
- **–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å**: –ú–æ—Å–∫–≤–∞ = UTC+3 (–±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –ª–µ—Ç–Ω–µ–µ –≤—Ä–µ–º—è)
- **–§—É–Ω–∫—Ü–∏—è**: `sendDailyTasksDigest()` –≤ `src/server/telegram-bot.ts`
- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –≤ `src/server/index.ts` –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞

---

## 2. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö

### –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∫ –∑–∞–¥–∞—á–µ –≤—Ç–æ—Ä–æ–π —É—á–∞—Å—Ç–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–≤–µ—Ç–∏—Ç—å –ø—Ä—è–º–æ –∏–∑ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞.

### –ö—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç:
- **–°–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞–¥–∞—á–∏** (`creatorId`), –µ—Å–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–∏–ª –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
- **–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∑–∞–¥–∞—á–∏** (`assigneeId`), –µ—Å–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–∏–ª —Å–æ–∑–¥–∞—Ç–µ–ª—å
- –ê–≤—Ç–æ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è **–Ω–µ –ø–æ–ª—É—á–∞–µ—Ç** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–≤–æ—ë–º –∂–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### –£—Å–ª–æ–≤–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏

- –£ –ø–æ–ª—É—á–∞—Ç–µ–ª—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω Telegram (`telegramChatId != null`)
- –ü–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
- –í –∑–∞–¥–∞—á–µ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –¥–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞ (—Å–æ–∑–¥–∞—Ç–µ–ª—å –∏/–∏–ª–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)

### –§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```
üí¨ –ù–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–¥–∞—á–µ

üìã –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
üìÅ –ü—Ä–æ–µ–∫—Ç: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
üë§ –û—Ç: –ò–º—è –∞–≤—Ç–æ—Ä–∞
üïí 18.11.2025, 12:34

üìù –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–ø–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤)

–ù–∞–∂–º–∏—Ç–µ ¬´–û—Ç–≤–µ—Ç–∏—Ç—å¬ª, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ –∑–∞–¥–∞—á–µ.
üîó –û—Ç–∫—Ä—ã—Ç—å –∑–∞–¥–∞—á—É: http://example.com/tasks/task-id

[–ö–Ω–æ–ø–∫–∞: –û—Ç–≤–µ—Ç–∏—Ç—å] [–ö–Ω–æ–ø–∫–∞: –û—Ç–∫—Ä—ã—Ç—å –∑–∞–¥–∞—á—É]
```

### –ö–∞–∫ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

1. **–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û—Ç–≤–µ—Ç–∏—Ç—å"** –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏
2. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ: "‚úçÔ∏è –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º"
3. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞** –æ–±—ã—á–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –±–æ—Ç—É
4. –í–∞—à —Ç–µ–∫—Å—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–¥–∞—á–µ
5. –ë–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç: "‚úÖ –í–∞—à –æ—Ç–≤–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–¥–∞—á–µ"

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö**: `TelegramPendingReply` —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ callback**: `handleReplyCallback()` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–û—Ç–≤–µ—Ç–∏—Ç—å"
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–∞**: `handleTextReply()` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç
- **–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è**: `addTaskCommentFromUser()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ —Å–æ–∑–¥–∞—ë—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/tasks/:id/comments` –¥–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `sendTaskCommentNotification()`

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞–¥–∞—á–µ: "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π. –í–æ–∑–º–æ–∂–Ω–æ, —É –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞..."
- –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞: —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è (`TelegramPendingReply`) —É–¥–∞–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–ª–∏ –æ—à–∏–±–∫–∏
- –û—à–∏–±–∫–∏ Telegram-–ª–æ–≥–∏–∫–∏ **–Ω–µ –ª–æ–º–∞—é—Ç** –æ—Å–Ω–æ–≤–Ω–æ–π HTTP-—Ñ–ª–æ—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞

- **–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è —á–µ—Ä–µ–∑ Telegram** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞, —á—Ç–æ –∏ HTTP-—ç–Ω–¥–ø–æ–∏–Ω—Ç
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
  - –°–æ–∑–¥–∞—Ç–µ–ª–µ–º –∑–∞–¥–∞—á–∏, –∏–ª–∏
  - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º –∑–∞–¥–∞—á–∏, –∏–ª–∏
  - –£—á–∞—Å—Ç–Ω–∏–∫–æ–º –ø—Ä–æ–µ–∫—Ç–∞, –∏–ª–∏
  - –í–ª–∞–¥–µ–ª—å—Ü–µ–º –ø—Ä–æ–µ–∫—Ç–∞

### –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω–∏—Ç—Å—è **–Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ** –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
- –ü—Ä–∏ –Ω–æ–≤–æ–º –Ω–∞–∂–∞—Ç–∏–∏ "–û—Ç–≤–µ—Ç–∏—Ç—å" —Å—Ç–∞—Ä–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è **–Ω–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü–µ—Ä–≤–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–≤–µ—Ç, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ - –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è

### CodeQL

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É CodeQL –±–µ–∑ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Telegram Bot Token (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
TELEGRAM_BOT_TOKEN=your-telegram-bot-token-here

# Frontend URL –¥–ª—è —Å—Å—ã–ª–æ–∫ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
FRONTEND_URL=http://localhost:5173
# –∏–ª–∏
APP_URL=http://localhost:5173

# –î—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `telegram_pending_replies`:

```sql
CREATE TABLE "telegram_pending_replies" (
    "id" TEXT NOT NULL,
    "userId" TEXT NOT NULL,
    "chatId" TEXT NOT NULL,
    "taskId" TEXT NOT NULL,
    "parentCommentId" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "telegram_pending_replies_pkey" PRIMARY KEY ("id")
);

CREATE INDEX "telegram_pending_replies_chatId_idx" ON "telegram_pending_replies"("chatId");
CREATE INDEX "telegram_pending_replies_userId_idx" ON "telegram_pending_replies"("userId");
```

–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤: `prisma/migrations/20251118010519_add_telegram_pending_reply/`

---

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `TELEGRAM_BOT_TOKEN` –≤ `.env`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä: `npm run dev:server`
3. –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. –í –ª–æ–≥–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è:
   ```
   ü§ñ Telegram bot initialized successfully
   ‚è∞ Daily digest cron job initialized (06:00 UTC / 09:00 Moscow time)
   ```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–π–¥–∂–µ—Å—Ç–∞

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–π–¥–∂–µ—Å—Ç–∞ –≤—Ä—É—á–Ω—É—é –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é:

```typescript
import { sendDailyTasksDigest } from './src/server/telegram-bot.js';

// –í—ã–∑–≤–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–º–∏–Ω—É—è cron)
await sendDailyTasksDigest();
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

1. –ü—Ä–∏–≤—è–∂–∏—Ç–µ Telegram-–∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ –±–æ—Ç–∞ (–∫–æ–º–∞–Ω–¥–∞ `/start` –∏ –≤–≤–æ–¥ LINK-–∫–æ–¥–∞)
2. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–¥–∞—á—É —Å –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
3. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –í—Ç–æ—Ä–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
5. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–≤–µ—Ç–∏—Ç—å" –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§–∞–π–ª—ã

- `src/server/telegram-bot.ts` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞
- `src/server/telegram-utils.ts` - —É—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
- `src/server/index.ts` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å HTTP-—ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è cron
- `prisma/schema.prisma` - –º–æ–¥–µ–ª—å `TelegramPendingReply`

### –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- `sendDailyTasksDigest()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –¥–∞–π–¥–∂–µ—Å—Ç–∞
- `sendTaskCommentNotification()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- `getCommentNotificationRecipient()` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `handleReplyCallback()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "–û—Ç–≤–µ—Ç–∏—Ç—å"
- `handleTextReply()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
- `addTaskCommentFromUser()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–æ—Å—Ç—É–ø–∞

### –£—Ç–∏–ª–∏—Ç—ã

- `getPriorityTag()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–≥–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
- `getMoscowDate()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏ –ø–æ –ú–æ—Å–∫–≤–µ
- `getMoscowDayStart()` - –Ω–∞—á–∞–ª–æ –¥–Ω—è –ø–æ –ú–æ—Å–∫–≤–µ
- `getMoscowDayEnd()` - –∫–æ–Ω–µ—Ü –¥–Ω—è –ø–æ –ú–æ—Å–∫–≤–µ
- `formatDeadline()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–∞ ("—Å–µ–≥–æ–¥–Ω—è", "–∑–∞–≤—Ç—Ä–∞", "DD.MM")

---

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å**: –∂—ë—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω UTC+3 –¥–ª—è –ú–æ—Å–∫–≤—ã (–±–µ–∑ DST)
2. **–õ–∏–º–∏—Ç –∑–∞–¥–∞—á**: –≤ –¥–∞–π–¥–∂–µ—Å—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–æ 10 –∑–∞–¥–∞—á –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
3. **–î–ª–∏–Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è**: –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤
4. **–û–¥–Ω–æ –æ–∂–∏–¥–∞–Ω–∏–µ**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ–∂–∏–¥–∞—Ç—å –æ—Ç–≤–µ—Ç–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–∏–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
5. **WebSocket**: —Å–æ–±—ã—Ç–∏—è `comment:added` –∏–∑–ª—É—á–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–¥–∞—á –ø—Ä–æ–µ–∫—Ç–∞

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:

- `üì§` - —É—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `‚ö†Ô∏è` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–æ—Ç –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω)
- `‚ÑπÔ∏è` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ–∑ Telegram)
- `‚ùå` - –æ—à–∏–±–∫–∏

–í—Å–µ –æ—à–∏–±–∫–∏ Telegram-–ª–æ–≥–∏–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ **–Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç** –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–ª–æ—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
